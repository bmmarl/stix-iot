{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "iot-traffic",
  "description": "The IoT Traffic Object represents arbitrary ZigBee and IEEE 802.15.4 traffic within an IoT network that originates from a source and is addressed to a destination.",
  "type": "object",
  "$ref": "static/jsedit/common/cyber-observable-core.json",
  "properties": {
    "type": {
      "type": "string",
      "description": "The value of this property MUST be `iot-traffic`.",
      "default": "iot-traffic",
      "readonly": "true"
    },
    "id": {
      "title": "id",
      "pattern": "^iot-traffic--",
      "readonly": "true"
    },
    "extensions": {
      "$ref": "#/definitions/iot-traffic-extensions-dictionary",
      "description": "The IoT Traffic Object defines the following extensions. In addition to these, producers MAY create their own. Extensions: ieee-802-15-4-ext, zigbee-nwk-ext, zigbee-sec-ext, zigbee-aps-ext, zigbee-zcl-ext, zigbee-zdp-ext"
    },
    "start": {
      "$ref": "static/jsedit/common/timestamp.json",
      "description": "Specifies the date/time the network traffic was initiated, if known."
    },
    "end": {
      "$ref": "static/jsedit/common/timestamp.json",
      "description": "Specifies the date/time the network traffic ended, if known."
    },
    "src_ref": {
      "description": "Specifies the source of the network traffic, as a reference to an Observable Object.",
      "type": "string"
    },
    "dst_ref": {
      "description": "Specifies the destination of the network traffic, as a reference to an Observable Object.",
      "type": "string"
    },
    "protocols": {
      "type": "array",
      "description": "Specifies the protocols observed in the ZigBee Traffic.",
      "items": {
        "type": "string"
      },
      "minItems": 1
    },
    "length": {
      "type": "string",
      "description": "Specifies the Length of the frame."      
    }
  },
  "required": [
    "type",
    "id",
    "protocols"
  ],
  "definitions": {
    "iot-traffic-extensions-dictionary": {
      "allOf": [{ "$ref": "static/jsedit/common/dictionary.json" }],
      "patternProperties": {
        "^ieee-802-15-4-ext$": {
          "type": "object",
          "description": "The IEEE 802.15.4 extension defines an extension for capturing values within fields specified by IEEE 802.15.4",
          "allOf": [
              {
                  "properties": {
                    "mac-src": {
                      "type" : "string",
                      "description": "Specifies the MAC source address of the frame."
                    },
                    "mac-dst": {
                      "type": "string",
                      "description": "Specifies the MAC destination address of the frame."
                    },
                    "dst-pan": {
                      "type": "string",
                      "description": "Specifies the Personal Area Network destination address of the frame."
                    },
                    "mac-sn": {
                      "type": "string",
                      "description": "Specifies the MAC Sequence Number of the frame."
                    },
                    "src-64": {
                      "type": "string",
                      "description": "64-Bit MAC address assigned by manufacturer."
                    },
                    "fcs": {
                      "description": "Specifies the frame sequence Frame Check Sequence of the frame.",
                      "type": "string"
                    },
                    "frame-type": {
                     "description": "Signifies the type of frame.",
                     "type": "string"
                    },
                    "security-enabled": {
                      "description": "Indicates whether the security features are enabled.",
                      "type": "string"
                    },
                    "frame-pending": {
                      "description": "Indicates if more frames are pending for the recipient.",
                      "type": "string"
                    },
                    "acknowledgement-request": {
                      "description": "Indicates frame is requesting an acknowledgement for the frame.",
                      "type": "string"
                    },
                    "pan-id-compression": {
                      "description": "Indicates if the PAN ID is compressed in the adressing fields.",
                      "type": "string"
                    },
                    "sequence-number-compression": {
                      "description": "Indicates if the PAN ID is compressed in the adressing fields.",
                      "type": "string"
                    },
                    "information-elements-present": {
                      "description": "Indicates if Informatin Elements are present in the frame.",
                      "type": "string"
                    },
                    "sequence-number": {
                      "description": "Specifies the Sequence Number of the frame.",
                      "type": "string"
                    },
                    "source-addressing-mode": {
                      "description": "Specifies the Addressing Mode the source utilizes (16 or 64 bit).",
                      "type": "string"
                    },
                    "dst-addressing-mode": {
                      "description": "Specifies the Addressing Mode the destination utilizes (16 or 64 bit).",
                      "type": "string"
                    },
                    "frame-control-field": {
                      "description": "Specifies the frame control field in the WPAN section.",
                      "type": "string"
                    },
                    "origin": {
                      "description": "Specifies the WPAN Origin.",
                      "type": "string"
                    },
                    "command-id": {
                      "description": "Specifies the WPAN Commadn ID.",
                      "type": "string"
                    },
                    "frame-version": {
                      "description": "Specifies the version of IEEE 802.15.4 the frame uses.",
                      "type": "string"
                    }
                 }
              }
          ]
        },
        "^zigbee-nwk-ext$": {
          "type": "object",
          "description": "The ZigBee extension defines an extension for capturing traffic properties associated with ZigBee Network Traffic. ",
          "allOf": [
              {
                  "properties": {
                    "zbee-nwk-src": {
                      "description": "Specifies the 16-bit ZigBee Network Source address of the frame.",
                      "type": "string"
                    },
                    "zbee-nwk-dst": {
                      "description": "Specifies the 16-bit ZigBee Network Destination address of the frame.",
                      "type": "string"
                    },
                    "nwk-frame-control-field": {
                      "description": "Specifies the 16-bit value in Frame Control Field.",
                      "type": "string"
                    },
                    "radius": {
                      "description": "Specifies a 1-byte value that is used as an indication of how far-reaching a signal is intended to go.",
                      "type": "string"
                    },
                    "origin": {
                      "description": "Specifies the origin value of the traffic.",
                      "type": "string"
                    },
                    "command-id": {
                      "description": "Indicates the Command the traffic is issuing.",
                      "type": "string"
                    },
                    "command-options": {
                      "description": "Specifies which options are enabled for the command.",
                      "type": "string"
                    },
                    "route-id": {
                      "description": "Identifies the route the traffic is taking.",
                      "type": "string"
                    },
                    "path-cost": {
                      "description": "Indicates the Path Cost Value of the Frame",
                      "type": "string"
                    },
                    "rejoin": {
                      "description": "Indicates if this traffic is a Rejoin request ",
                      "type": "string"
                    },
                    "leave": {
                      "description": "Indicates if this traffic is a Leave request ",
                      "type": "string"
                    },
                    "remove-children": {
                      "description": "Indicates if this traffic is request to remove its children nodes.",
                      "type": "string"
                    },
                    "requested-timeout-enumeration": {
                      "description": "Indicates the alloted amount of time before the end device times out",
                      "type": "string"
                    },
                    "nwk-desintion": {
                      "description": "Indicates the network desintion for routing information.",
                      "type": "string"
                    },
                    "nwk-extended-src": {
                      "description": "Specifies the 64-bit MAC address of the source device.",
                      "type": "string"
                    },
                    "nwk-sequence-number": {
                      "description": "Specifies the dequence number of the Zigbee Network traffic.",
                      "type": "string"
                    },
                    "end-device-config":{
                      "description": "Specifies the end device configuration",
                      "type": "string"
                    }
                  }
            }
          ]
        },
        "^zigbee-aps-ext$": {
          "type": "object",
          "description": "The ZigBee Application Support (APS) Sub-layer extension provoides an extension capturing traffic properties associated with ZigBee APS.",
          "allOf": [
              {
                  "properties": {
                    "key": {
                      "description": "Specifies the encryption key value that is being transferred to an end device.",
                      "type": "string"
                    },
                    "key-type": {
                      "description": "Specifies type of encryption key that is being delivered.",
                      "type": "string"
                    },
                    "profile": {
                      "description": "Specifies the Profile that the traffic is using.",
                      "type": "string"
                    },
                    "cluster": {
                      "description": "Specifies the Cluster that the traffic is using.",
                      "type": "string"
                    },
                    "destination-endpoint": {
                      "description": "Specifies the desintaion endpoint value.",
                      "type": "string"
                    },
                    "counter-value": {
                      "description": "Specifies the counter value.",
                      "type": "string"
                    },
                    "dst-endpoint": {
                      "description": "Specifies the destintion endpoint value.",
                      "type": "string"
                    },
                    "src-endpoint": {
                      "description": "Specifies the source endpoint value.",
                      "type": "string"
                    },
                    "device-address": {
                      "description": "Specifies the APS device address.",
                      "type": "string"
                    },
                    "counter": {
                      "description": "Specifies the APS counter value.",
                      "type": "string"
                    },
                    "sequence-number": {
                      "description": "Specifies the APS sequence number.",
                      "type": "string"
                    },
                    "extended-source": {
                      "description": "Specifies the APS 64-bit extended source value.",
                      "type": "string"
                    },
                    "extended-dest": {
                      "description": "Specifies the APS 64-bit extended desintaion value.",
                      "type": "string"
                    }
                }
              }
          ]
        },
        "^zigbee-sec-ext$": {
          "type": "object",
          "description": "The ZigBee Security extension provides an extension for caputring secuirty properties associated with ZigBee traffic.",
          "allOf": [
            {
              "properties": {
                "security-control-field": {
                  "description": "Specifies the value of the Security Conrol field in the Security header.",
                  "type": "string"
                },
                "frame-counter": {
                  "description": "Specifies the value of the counter in the Security header.",
                  "type": "string"
                },
                "message-intergrity-code": {
                  "description": "Specifies the value of the mic in the Security header.",
                  "type": "string"
                },
                "key": {
                  "description": "Specifies the value of the ZigBee network key the traffic was encrpyted with.",
                  "type": "string"
                },
                "key-label": {
                  "description": "Specifies the label of the key.",
                  "type": "string"
                },
                "extended-src": {
                  "description": "Extended source in the security header.",
                  "type": "string"
                },
                "key-sequence-number": {
                  "description": "Key sequence number in security header.",
                  "type": "string"
                }
              }
            }
          ]
        },
        "^zigbee-zcl-ext$": {
          "type": "object",
          "description": "The ZigBee Cluster Library extenions provides an extension for cluster properties associted with ZigBee traffic.",
          "allOf": [
            {
              "properties": {
                "manufacturer-code": {
                  "description": "Specifies the manufacturer code of the device generating trafic.",
                  "type": "string"
                },
                "sequence-num": {
                  "description": "Specifies sequence number of the ZCL traffic",
                  "type": "string"
                },
                "command": {
                  "description": "Specifies the command being issued in the traffic",
                  "type": "string"
                },
                "command-response": {
                  "description": "Specifies the command response being delivered in the traffic",
                  "type": "string"
                },
                "status": {
                  "description": "Specifies the status of the ZCL command issued",
                  "type": "string"
                }
              }
            }
          ]
        },
        "^zigbee-zdp-ext$": {
          "type": "object",
          "description": "The ZigBee Cluster Library extenions provides an extension for cluster properties associted with ZigBee traffic.",
          "allOf": [
            {
              "properties": {
                "sequence-num": {
                  "description": "Specifies ZDP sequence number",
                  "type": "string"
                },
                "extended-address": {
                  "description": "Specifies 64-bit ZDP address",
                  "type": "string"
                },
                "remove-children": {
                  "description": "Indicates  ZDP Remove Children Command",
                  "type": "string"
                },
                "rejoin": {
                  "description": "Indicates ZDP Rejoin Command",
                  "type": "string"
                },
                "network-address-of-intrest": {
                  "description": "Indicates ZDP Network Address of Intrest",
                  "type": "string"
                }
              }
            }
          ]
        }
      },
      "additionalProperties": {
        "$ref": "static/jsedit/common/dictionary.json",
        "description": "Custom file extension"
      }
    }
  }
}

