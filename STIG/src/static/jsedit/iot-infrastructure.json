{
  "$id": "https://raw.githubusercontent.com/bmmarl/stix-iot/refs/heads/main/STIG/src/static/jsedit/iot-infrastructure.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "iot-infrastructure",
  "description": "IoT Infrastructure objects describe physical IoT devices, sensors, hubs, etc.",
  "type": "object",
  "allOf": [
    {
      "$ref": "static/jsedit/core.json"
    },
    {
      "properties": {
        "type": {
          "type": "string",
          "description": "The type of this object, which MUST be the literal `iot-infrastructure`.",
          "enum": [
            "infrastructure"
          ]
        },
        "id": {
          "title": "id",
          "pattern": "^iot-infrastructure--"
        },
        "name": {
          "type": "string",
          "description": "The name used to identify the IoT Infrastructure."
        },
        "description": {
          "type": "string",
          "description": "A description that provides more details and context about this IoT Infrastructure potentially including its purpose and its key characteristics."
        },
        "infrastructure_function": {
          "type": "array",
          "description": "This field is an Open Vocabulary that specifies the function of the IoT Infrastructure component. Open vocab - iot-infrastructure-type-ov",
          "items": {
            "type": "string", 
            "$ref": "#/definitions/iot-infrastructure-type-ov"
            
          },
          "minItems": 1
        },
        "aliases": {
          "type": "array",
          "description": "Alternative names used to identify this IoT Infrastructure.",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "kill_chain_phases": {
          "type": "array",
          "description": "The list of kill chain phases for which this IoT infrastructure is used.",
          "items": {
            "$ref": "static/jsedit/common/kill-chain-phase.json"
          },
          "minItems": 1
        },
        "first_seen": {
          "title":"first_seen",
          "$ref": "static/jsedit/common/timestamp.json",
          "description": "The time that this IoT infrastructure was first seen performing malicious activities."
        },
        "last_seen": {
          "title":"last_seen",
          "$ref": "static/jsedit/common/timestamp.json",
          "description": "The time that this IoT infrastructure was last seen performing malicious activities."
        }
      }
    }
  ],
  "required": [
    "name"
  ],
  "definitions": {
    "iot-infrastructure-type-ov": {
      "type": "string",
      "enum": [
        "Coordinator",
        "Router",
        "End Device"
      ]
    }
  }
}
